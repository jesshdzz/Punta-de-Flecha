// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id         Int        @id @default(autoincrement())
  nombre     String
  correo     String     @unique
  telefono   String
  contrasena String
  puesto     RolUsuario
  createdAt  DateTime   @default(now())
}

model Estudiante {
  id            Int           @id
  usuarioId     Int
  grupoId       Int?
  grupo         Grupo?        @relation(fields: [grupoId], references: [id])
  inscripciones Inscripcion[]
  Pago          Pago[]
  Tramite       Tramite[]
}

model Grupo {
  id          Int          @id @default(autoincrement())
  nombre      String
  estudiantes Estudiante[]
}

model Tramite {
  id           Int        @id @default(autoincrement())
  estudianteId Int
  tipo         String
  estado       String
  fecha        DateTime   @default(now())
  estudiante   Estudiante @relation(fields: [estudianteId], references: [id])
}

model Inscripcion {
  id           Int        @id @default(autoincrement())
  estudianteId Int
  grupoId      Int
  fecha        DateTime   @default(now())
  estudiante   Estudiante @relation(fields: [estudianteId], references: [id])
}

model Pago {
  id           Int        @id @default(autoincrement())
  estudianteId Int
  concepto     String
  monto        Float
  fecha        DateTime   @default(now())
  estado       String
  estudiante   Estudiante @relation(fields: [estudianteId], references: [id])
  recibos      Recibo[]
}

model Recibo {
  id     Int      @id @default(autoincrement())
  pagoId Int
  fecha  DateTime @default(now())
  pago   Pago     @relation(fields: [pagoId], references: [id])
}

enum RolUsuario {
  ADMINISTRADOR
  PROFESOR
  ESTUDIANTE
  PADRE_FAMILIA
  SECRETARIA
}
